# Amber Discord Bot Container

This image packages the Amber org wrapper around the shared casting Discord bot so it can be deployed without the rest of the monorepo tooling.

## Build

Use the repository root as the build context so the Dockerfile can prime dependencies with `uv` and then copy in the full workspace:

```bash
docker build -f orgs/casting-systems/apps/amber/Dockerfile -t amber-bot:latest .
```

During the build `uv sync` installs the org workspace (including `libs/org-rules`) into `/workspace/orgs/casting-systems/.venv`. Published dependencies such as `casting-query-bot` are resolved from your configured package index.

## Run

Provide the Discord credentials (and any optional config) as environment variables at runtime:

```bash
docker run \
  --rm \
  --env BOT_TOKEN=your-discord-bot-token \
  amber-bot:latest
```

Optional settings:

- `BOT_ID`: Discord application ID if command registration should target a single application.
- `APP_ENV`: choose the environment layer for `.env` resolution (defaults to `dev`; use `prod` to skip loading `.env`).

Mount an external volume if you need to persist artifacts generated by the shared bot (for example, `var/` paths declared in `apps/casting-query-bot`).

## Updating

When the upstream `casting-query-bot` or shared libraries change, rebuild the image so the Amber wrapper picks up the new code:

```bash
docker build -f orgs/casting-systems/apps/amber/Dockerfile --pull -t amber-bot:latest .
```
